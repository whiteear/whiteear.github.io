<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="whiteear" />
    <meta name="viewport" content="width=device-width"> 
    <title>Git Cookbook | whiteear</title>
	<!-- Jim disable
	script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?autoload=true&skin=Desert"></script-->
    <link href="/feed/" rel="alternate" title="whiteear" type="application/atom+xml" />
    <link rel="shortcut icon" href="/favicon.ico"/>
	<link rel="icon" href="http://blog.sevenche.com/favicon.ico"/>

    <link rel="stylesheet" href="/media/css/highlight.css">
    <link href='/media/webfonts/ss-social.css' rel='stylesheet'>
    <link href='/media/webfonts/ss-standard.css' rel='stylesheet'>

    <script language="JavaScript"><!--
        if (navigator.userAgent.match(/iPhone|iPod|Android|IEMobile/i)) {
            document.write("<link href=\"/media/css/screen-mobil.css\" rel=\"stylesheet\">");
        } else {
            document.write("<link href=\"/media/css/screen.css\" rel=\"stylesheet\">");
        }
        // -->
    </script>

    <!--script type="text/javascript" src="/media/js/jquery-1.7.1.min.js"></script-->
    <script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.2.min.js"></script>
	
  </head>
  <body>
    <div id="container">
      <div id="main" role="main">
        <header>
        <div class="buttons">
          <a href="/" class="ss-icon" title="Go to homepage">home</a>
          <a href="/categories" class="ss-icon" title="Category" >list</a>
          <a href="/tags" class="ss-icon" title="Tag Cloud" >tags</a>
          <a href="/guestbook" class="ss-icon" title="Guest Book" >talk</a>
          <a href="/about" class="ss-icon" title="About" >user</a>
          <a href="/feed" class="ss-icon" title="Subscribe by RSS" >rss</a>
        </div>
        <h1>Git Cookbook</h1>
        </header>
        <hr>
        <article class="content">
        <section class="post">
<blockquote><p>本文始于自己的Evernote，由于大部分原本是英文记录的，所以干脆全部用英文。</p>

<p>Most of the content comes from my Evernote, therefore, this post will be updated once I have more notes, and you are highly welcome to contribute your notes to this article or point out any mistake.</p></blockquote>

<h3>How to see simple git log?</h3>

<hr />

<p>The following let you to see only one line comment for each commit.</p>

<p><code>
git log --oneline
git log --oneline -3
</code>
Below command let you to display Gitk-alike tree to your shell screen. And <code>--global alias.pl</code> allows you to use the short form of command. like <code>$ git pl</code>.</p>

<p><code>
git log --oneline --graph --decorate
git config --global alias.pl "log --oneline --graph --decorate"
</code>
Usage:</p>

<p><img src="/media/pic2014/0203-1.png" alt="" /></p>

<h3>How to see log in another branch?</h3>

<hr />

<p><code>shell
git log origin/master..
</code></p>

<h3>How to search keywords in commit comment (across all branches)?</h3>

<hr />

<p>If you want to know how a feature was implemented you can start by search the keywords in the log history and then diff it. From my experience, most of times this method is faster than search in the IDE.</p>

<p><code>
git log --all --grep='a keyword'
</code>
<strong>Note</strong>
<code>--grep</code> can bring you the entire commit message instead of ONE line which contains the keywords. This command is better than the shell <code>grep</code> command <code>git log --all |grep 'keyword'</code> because the later only gives you one line result and you cannot see ALL comment of a commit.</p>

<h3>How to see history of one file?</h3>

<hr />

<p>You have many options to achieve that goal.</p>

<p><code>
git log -- [filename] (show the log history)
git log -p filename (Diff the code; git generate the patches for each log entry)
gitk [filename] (Show the content changed)
git log --follow &lt;filename&gt; (Show rename)
</code></p>

<h3>How to only produce one commit for a merge?</h3>

<hr />

<p>Think about you have a dev branch and a main branch and you have a lot of commits in your dev branch, but when merge code you don't want all those comment history goes to the main branch(the main branch history could be more meaningful). use <code>--squash</code> to only produce one new commit for the merge.</p>

<p><code>
git merge --squash bugfix
git commit -m 'fix bug'
</code></p>

<h3>How to only see local commit log?</h3>

<hr />

<p>The following gives you two ways to see that.</p>

<p><code>
git log --no-merges master..
git log -g
</code></p>

<h3>How to revert to a commit?</h3>

<hr />

<p><code>
git reset --hard 4a155e5
and then
git push -f origin master
</code>
<strong>Notice</strong> git revert will not work here! <code>git revert</code> can only revert one commit. If you have commit <code>11,22,33,44,</code> and you <code>git revert 22</code> then you will have commit <code>11,33,44</code>, but if you <code>git reset --hard 22</code> and commit, then you could only have <code>11</code> in your commit history.</p>

<h3>How to find a lost commit?</h3>

<hr />

<p>Sometimes we could lost our commit(For example you are working on a detached HEAD). As a last resort in case your commit is dangling and not connected to history at all, you can search the reflog itself with the <code>-g</code> flag (short for <code>--walk-reflogs</code>)</p>

<p><code>
git log -g --grep='Build 0051'
</code>
<strong>This is because that the reflog contains the local history.</strong>
After you get the SHA-1 for you commit. You can check it out.</p>

<h3>How to know which branch is the most recent?</h3>

<hr />

<p>Once you cloned a huge repo, and a lot of branch can be found within it - some of them are not active because the feature development was completed. How to know which branch to use? My way is to sort these branches by commit time, so we know which branch is fresh.</p>

<p><code>
git config --global alias.latest "for-each-ref --sort=-committerdate --format='%(committerdate:short) %(refname:short)'"
</code></p>

<p><strong>Usage:</strong></p>

<p>```
$ cd ~/Code/rails/rails &amp;&amp; git latest
2012-11-19 origin/master
2012-11-19 origin/HEAD
2012-11-19 master
2012-11-19 origin/3-2-stable
2012-11-03 origin/encrypted_cookies
2012-11-03 origin/attributes_perf
... snipped ...</p>

<p>```
Show local branches only:</p>

<p><code>
git config --global alias.latest "for-each-ref --sort=-committerdate refs/heads --format='%(committerdate:short) %(refname:short)'"
</code></p>

<h3>How to change the remote HEAD</h3>

<hr />

<p>```
git branch -a
remotes/origin/HEAD -> origin/gh-pages
remotes/origin/gh-pages
remotes/origin/master</p>

<p>git remote set-head origin master
git branch -a
remotes/origin/HEAD -> origin/master
remotes/origin/gh-pages
remotes/origin/master
```</p>

<h3>How to delete a remote git branch?</h3>

<hr />

<p><code>
git push origin --delete &lt;branchName&gt;
</code></p>

<h3>How to delete the merge orig file?</h3>

<hr />

<p>Some automatically generated <code>*.orig</code> files will be left in your working folder after a successful merge. One quick way to delete them could be</p>

<p><code>
git clean -f
</code></p>

<p><strong>Beware</strong> There's no going back. Use <code>-n</code> or <code>--dry-run</code> to preview the damage you'll do.
 <code>git-clean</code>  Remove untracked files from the working tree
If you want to also remove directories, run <code>git clean -f -d</code>
If you just want to remove ignored files, run <code>git clean -f -X</code>
If you want to remove ignored as well as non-ignored files, run <code>git clean -f -x</code>
Note the case difference on the X for the two latter commands.</p>

<h3>How to know the remote branch names?</h3>

<hr />

<p>OK, you got a huge repository, maybe the first step is to know the remote branch names.</p>

<p><code>
git branch -r
</code></p>

<h3>How to rename a file?</h3>

<p><code>
$ git mv README README.md
$ git commit -m "renamed"
$ git push origin master
</code></p>

<h3>How to pull a remote branch?</h3>

<hr />

<p>Before you can start working locally on a remote branch, you need to fetch it as called out in answers below.
To fetch a branch, you simply need to:</p>

<p><code>
git fetch origin
git branch -r
</code></p>

<p>This will fetch all of the remote branches for you. With the remote branches in hand, you now need to check out the branch you are interested in, giving you a local working copy:</p>

<p><code>
git checkout -b test origin/test
</code></p>

</section>
<section class="meta">
<hr/>
<!-- disable jim related info 
<span class="author">
  <a href="http://blog.sevenche.com">whiteear</a> - Software Engineer with more than 7 years experience related to Java, Android and C++. He is now working for Avaya Emerging Product and Technology Department Shanghai, China.
</span>
<br /> -->
<span class="license">
  Published under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">(CC) BY-NC-SA</a>
</span>

<span class="categories">
  in categories
  
  <a href="/categories/#Common Tec" title="Common Tec">Common Tec</a>&nbsp;
  
</span>


<span class="tags">
  tagged with 
  
  <a href="/tags/#Git" title="Git">Git</a>&nbsp;
  
</span>

<span class="time">
  <br/>
  <time datetime="2014-02-03">2014-02-03</time>
</span>
</section>
<section class="comment">
<!-- baidu JIA -->
<div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a title="分享到QQ空间" href="#" class="bds_qzone" data-cmd="qzone"></a><a title="分享到新浪微博" href="#" class="bds_tsina" data-cmd="tsina"></a><a title="分享到腾讯微博" href="#" class="bds_tqq" data-cmd="tqq"></a><a title="分享到人人网" href="#" class="bds_renren" data-cmd="renren"></a><a title="分享到微信" href="#" class="bds_weixin" data-cmd="weixin"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
<!-- end of baidu JIA -->
<!-- Disqus Comment BEGIN -->
 <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'whiteear'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <!--a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a-->
    
<!-- Disqus Comment END -->
</section>


<script type="text/javascript">
$(function(){
  $(document).keydown(function(e) {
    var url = false;
        if (e.which == 37 || e.which == 74) {  // Left arrow and J
            
        url = 'http://whiteear.github.io//2014/02/Flex-real-time-video-app/';
        
        }
        else if (e.which == 39 || e.which == 75) {  // Right arrow and K
            
        url = 'http://whiteear.github.io//2014/02/Air-Application-Debug-in-Android/';
        
        }
        if (url) {
            window.location = url;
        }
  });
})

</script>

<style type="text/css">
/*resize the big pic*/
div.resized_image p {
  margin: 2px;
  margin-top: 0;
  font-size: 8px;
  /* Awesome icon from here: http://www.famfamfam.com/lab/icons/silk/ */
  background: url(http://i242.photobucket.com/albums/ff244/9861_omikron/error.png) no-repeat;
  padding-left: 20px;
  color: #333;
}
</style>
<script type="text/javascript">
//resize the big pic
$(window).load(function() {
  (
    function(maxht, maxwt, minht, minwt) {
      var imgs = document.getElementsByTagName('img');
      // Image resizing function
      var resize_image = function(img, newht, newwt) {
        img.height = newht;
        img.width  = newwt;
        $(img).wrap('<table><tr><td class="tborder"><div class="resized_image"><a href="' + img.src + '" target="_blank"></a></div></td></tr></table>');
        $(img).parent().before('<p>NOTE: This image was resized. To view it full-size, click on the image.</p>');
        //$(img).parent().after('<p style="text-align:right;background:none;margin:0;padding-right:3px">Image resizing script by <a href="http://aetus.net/217/programming/automatically-resize-large-images-with-javascript/">Aetus Designs</a>.</p>');
      };
      
      for (var i = 0; i < imgs.length; i++) {
        // Set a variable for the current image to make the code make more sense.
        var img = imgs[i];
        if (img.height > maxht || img.width > maxwt) {
          // Use Ratios to constraint proportions.
          var old_ratio = img.height / img.width;
          var min_ratio = minht / minwt;
          // If it can scale perfectly.
          if (old_ratio === min_ratio) {
            resize_image(img, minht, minwt);
          } 
          // We need to do some magic now.
          else {
            var newdim = [img.height, img.width];
            // Sort out the height first.
            newdim[0] = minht;
            // The logic behind this is that if ratio = ht / wt, then wt = ht / ratio.
            newdim[1] = newdim[0] / old_ratio;
            // Do we still have to sort out the width?
            if (newdim[1] > maxwt) {
              // Just do what we did with the height
              newdim[1] = minwt;
              newdim[0] = newdim[1] * old_ratio;
            }
            // So yeah, resize the image
            resize_image(img, newdim[0], newdim[1]);
          }
        }
      }
    }
  )(780, 780, 780, 780);
});
</script>

        </article>
      </div>

    <footer>
        <p><small>Powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a> | Free hosted at <a href="https://github.com/dashjim">Github</a> | Copyright 2014 - 2014 by 
		<!-- *** Please Keep bellow link for at least 6 months! Thanks！*** -->
		<a href="http://blog.sevenche.com/about/">Template Maintained by Jim</a>
		
		| <span class="label label-info">2014-10-07 17:29:07 CST</span></small></p>
    </footer>

    </div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  /*ga('create', 'UA-47125213-1', 'sevenche.com');
  ga('send', 'pageview');*/

</script>
  </body>
</html>
